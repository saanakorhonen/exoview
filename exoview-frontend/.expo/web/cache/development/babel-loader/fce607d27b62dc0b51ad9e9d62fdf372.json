{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\n\nvar _this = this,\n    _jsxFileName = \"C:\\\\Users\\\\E\\\\uni\\\\tiea207\\\\exoview\\\\exoview\\\\exoview-frontend\\\\src\\\\screens\\\\Search.js\";\n\nimport 'react-native-gesture-handler';\nimport React, { useEffect, useState } from 'react';\nimport FlatList from \"react-native-web/dist/exports/FlatList\";\nimport Keyboard from \"react-native-web/dist/exports/Keyboard\";\nimport View from \"react-native-web/dist/exports/View\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport TextInput from \"react-native-web/dist/exports/TextInput\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport ScrollView from \"react-native-web/dist/exports/ScrollView\";\nimport { parse } from 'fast-xml-parser';\nimport { TouchableOpacity } from 'react-native-gesture-handler';\nimport { Menu, MenuProvider, MenuOptions, MenuOption, MenuTrigger } from \"react-native-popup-menu\";\nimport { set } from 'react-native-reanimated';\n\nvar Search = function Search(_ref) {\n  var navigation = _ref.navigation,\n      route = _ref.route;\n\n  var _useState = useState([]),\n      _useState2 = _slicedToArray(_useState, 2),\n      foundPlanets = _useState2[0],\n      setFoundPlanets = _useState2[1];\n\n  var _useState3 = useState([]),\n      _useState4 = _slicedToArray(_useState3, 2),\n      allPlanets = _useState4[0],\n      setAllPlanets = _useState4[1];\n\n  var _useState5 = useState(''),\n      _useState6 = _slicedToArray(_useState5, 2),\n      searchFilter = _useState6[0],\n      setFilter = _useState6[1];\n\n  var _useState7 = useState(''),\n      _useState8 = _slicedToArray(_useState7, 2),\n      searchTerm = _useState8[0],\n      changeSearchTerm = _useState8[1];\n\n  var _useState9 = useState(0),\n      _useState10 = _slicedToArray(_useState9, 2),\n      juoksevaluku = _useState10[0],\n      setJuoksevaluku = _useState10[1];\n\n  var _useState11 = useState('Search options'),\n      _useState12 = _slicedToArray(_useState11, 2),\n      menuTriggerText = _useState12[0],\n      setMenuTriggerText = _useState12[1];\n\n  useEffect(function () {\n    setAllPlanets(route.params);\n  }, []);\n  useEffect(function () {\n    setFoundPlanets(allPlanets);\n  }, [allPlanets]);\n\n  var renderFoundPlanets = function renderFoundPlanets() {\n    return foundPlanets.map(function (planet) {\n      return React.createElement(PlanetBrief, {\n        navigation: navigation,\n        data: planet,\n        key: generateKey(),\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 49,\n          columnNumber: 43\n        }\n      });\n    });\n  };\n\n  var parseSearchTerms = function parseSearchTerms() {\n    if (searchTerm === \"\" || searchFilter === \"\") {\n      Keyboard.dismiss();\n      setFilter(\"\");\n      setMenuTriggerText('Search Options');\n      return setFoundPlanets(allPlanets);\n    }\n\n    var searchedWord = '^' + searchTerm;\n    var filteredPlanetsAr = searchFilter !== 'pl_rade' && searchFilter !== 'pl_masse' ? allPlanets.filter(function (planet) {\n      return planet[searchFilter].toLowerCase().match(searchTerm.toLowerCase());\n    }) : allPlanets.filter(function (planet) {\n      return planet[searchFilter].toString().match(searchedWord);\n    });\n    setFoundPlanets(filteredPlanetsAr);\n    Keyboard.dismiss();\n  };\n\n  var handleTextChange = function handleTextChange(term) {\n    if (term === '') {\n      setFilter(\"\");\n      return setFoundPlanets(allPlanets);\n    }\n\n    changeSearchTerm(term);\n  };\n\n  var createQuery = function createQuery() {\n    var hakuehto = searchFilter;\n\n    if (hakuehto === '' || hakuehto === undefined) {\n      console.log(alku + loppu);\n      return alku + loppu;\n    }\n\n    var hakutermi = '+like+\\'' + searchTerm + '%\\'';\n    console.log(alku + hakuehto + hakutermi);\n    return alku + hakuehto + hakutermi;\n  };\n\n  var changeMenuTrigger = function changeMenuTrigger(filter) {\n    switch (filter) {\n      case \"pl_name\":\n        setMenuTriggerText(\"Planet name\");\n        break;\n\n      case \"hostname\":\n        setMenuTriggerText(\"Host star\");\n        break;\n\n      case \"pl_rade\":\n        setMenuTriggerText(\"Radius\");\n        break;\n\n      case \"pl_masse\":\n        setMenuTriggerText(\"Planet masse\");\n        break;\n\n      default:\n        setMenuTriggerText(\"Search options\");\n        break;\n    }\n  };\n\n  return React.createElement(MenuProvider, {\n    on: true,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 124,\n      columnNumber: 13\n    }\n  }, React.createElement(Menu, {\n    onSelect: function onSelect(filter) {\n      setFilter(filter);\n      changeMenuTrigger(filter);\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 125,\n      columnNumber: 17\n    }\n  }, React.createElement(MenuTrigger, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 130,\n      columnNumber: 25\n    }\n  }, React.createElement(Text, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 131,\n      columnNumber: 29\n    }\n  }, menuTriggerText)), React.createElement(MenuOptions, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 134,\n      columnNumber: 25\n    }\n  }, React.createElement(MenuOption, {\n    value: \"pl_name\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 135,\n      columnNumber: 29\n    }\n  }, React.createElement(Text, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 136,\n      columnNumber: 33\n    }\n  }, \"Planet name\")), React.createElement(MenuOption, {\n    value: \"hostname\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 139,\n      columnNumber: 29\n    }\n  }, React.createElement(Text, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 140,\n      columnNumber: 33\n    }\n  }, \"Host star\")), React.createElement(MenuOption, {\n    value: \"pl_rade\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 143,\n      columnNumber: 29\n    }\n  }, React.createElement(Text, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 144,\n      columnNumber: 33\n    }\n  }, \"Radius\")), React.createElement(MenuOption, {\n    value: \"pl_masse\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 147,\n      columnNumber: 29\n    }\n  }, React.createElement(Text, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 148,\n      columnNumber: 33\n    }\n  }, \"planet masse\")))), React.createElement(View, {\n    style: styles.searchBar,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 153,\n      columnNumber: 21\n    }\n  }, React.createElement(TextInput, {\n    style: styles.textInput,\n    onChangeText: function onChangeText(term) {\n      return handleTextChange(term);\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 154,\n      columnNumber: 25\n    }\n  }), React.createElement(TouchableOpacity, {\n    style: styles.button,\n    onPress: function onPress() {\n      return parseSearchTerms();\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 155,\n      columnNumber: 21\n    }\n  }, React.createElement(Text, {\n    style: styles.buttonText,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 156,\n      columnNumber: 25\n    }\n  }, \"Search\"))), React.createElement(FlatList, {\n    data: foundPlanets,\n    renderItem: function renderItem(_ref2) {\n      var item = _ref2.item;\n      return React.createElement(PlanetBrief, {\n        navigation: navigation,\n        data: item,\n        allPlanets: foundPlanets,\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 167,\n          columnNumber: 29\n        }\n      });\n    },\n    keyExtractor: function keyExtractor(item) {\n      return item.pl_name;\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 164,\n      columnNumber: 21\n    }\n  }));\n};\n\nvar generateKey = function generateKey() {\n  var keys = '1234567890abcdefghijklmnopqrstuvwxyz';\n  var idLength = 10;\n  var i = 0;\n  var id = '';\n\n  while (i < idLength) {\n    id = id + keys.charAt(Math.floor(Math.random() * Math.floor(keys.length)));\n    i++;\n  }\n\n  return id;\n};\n\nvar PlanetBrief = function PlanetBrief(props) {\n  var isVisible = false;\n\n  var toggleVisibility = function toggleVisibility() {\n    isVisible = !isVisible;\n  };\n\n  var renderView = function renderView() {\n    if (isVisible) {\n      return view;\n    }\n\n    return null;\n  };\n\n  var view = React.createElement(View, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 217,\n      columnNumber: 17\n    }\n  }, React.createElement(View, {\n    style: styles.infoWrapper,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 218,\n      columnNumber: 21\n    }\n  }, React.createElement(Text, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 219,\n      columnNumber: 25\n    }\n  }, \"Host star: \", props.data.hostname), React.createElement(Text, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 222,\n      columnNumber: 25\n    }\n  }, \"Masse: \", props.data.pl_masse), React.createElement(Text, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 225,\n      columnNumber: 25\n    }\n  }, \"Radius: \", props.data.pl_rade)), React.createElement(View, {\n    style: styles.buttonWrapper,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 234,\n      columnNumber: 21\n    }\n  }, React.createElement(TouchableOpacity, {\n    style: styles.button,\n    onPress: function onPress() {\n      return handleStarsystem2(props);\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 235,\n      columnNumber: 25\n    }\n  }, React.createElement(Text, {\n    style: styles.buttonText,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 235,\n      columnNumber: 106\n    }\n  }, \"View planet\")), React.createElement(TouchableOpacity, {\n    style: styles.button,\n    onPress: function onPress() {\n      return handleStarsystem(props);\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 236,\n      columnNumber: 25\n    }\n  }, React.createElement(Text, {\n    style: styles.buttonText,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 236,\n      columnNumber: 105\n    }\n  }, \"View host star\"))));\n  return React.createElement(View, {\n    style: styles.container,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 241,\n      columnNumber: 9\n    }\n  }, React.createElement(View, {\n    style: styles.headerWrapper,\n    onPress: toggleVisibility(),\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 242,\n      columnNumber: 13\n    }\n  }, React.createElement(Text, {\n    style: styles.header,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 243,\n      columnNumber: 17\n    }\n  }, props.data.pl_name)), renderView());\n};\n\nvar handleStarsystem = function handleStarsystem(props, allPlanets) {\n  var nimi = props.data.pl_name;\n  var kutsu = \"https://exoplanetarchive.ipac.caltech.edu/TAP/sync?query=select+top+1+st_spectype,st_teff,st_rad,st_mass,st_age,st_rotp+from+pscomppars+where+pl_name+like+\\'\" + nimi + \"\\'+order+by+disc_year+desc\";\n  fetchData(kutsu).then(function (data) {\n    var star = setStars(data, props.data.hostname);\n    var tahdenplaneetat = props.allPlanets.filter(function (planet) {\n      return planet['hostname'].match(star.hostname);\n    });\n    var system = {\n      star: star,\n      planets: tahdenplaneetat\n    };\n    props.navigation.navigate('StarSystem', system);\n  });\n};\n\nvar handleStarsystem2 = function handleStarsystem2(props, allPlanets) {\n  var nimi = props.data.pl_name;\n  var kutsu = \"https://exoplanetarchive.ipac.caltech.edu/TAP/sync?query=select+top+1+st_spectype,st_teff,st_rad,st_mass,st_age,st_rotp+from+pscomppars+where+pl_name+like+\\'\" + nimi + \"\\'+order+by+disc_year+desc\";\n  fetchData(kutsu).then(function (data) {\n    var star = setStars(data, props.data.hostname);\n    var tahdenplaneetat = props.allPlanets.filter(function (planet) {\n      return planet['hostname'].match(star.hostname);\n    });\n    var system = {\n      star: star,\n      planets: tahdenplaneetat\n    };\n    props.navigation.navigate('Information', {\n      planet: props.data,\n      system: system\n    });\n  });\n};\n\nvar fetchData = function fetchData(props) {\n  var response, teksti, objects, planetArray;\n  return _regeneratorRuntime.async(function fetchData$(_context) {\n    while (1) {\n      switch (_context.prev = _context.next) {\n        case 0:\n          _context.next = 2;\n          return _regeneratorRuntime.awrap(fetch(props));\n\n        case 2:\n          response = _context.sent;\n          _context.next = 5;\n          return _regeneratorRuntime.awrap(response.text());\n\n        case 5:\n          teksti = _context.sent;\n          _context.next = 8;\n          return _regeneratorRuntime.awrap(parse(teksti));\n\n        case 8:\n          objects = _context.sent;\n          planetArray = objects.VOTABLE.RESOURCE.TABLE.DATA.TABLEDATA.TR;\n          return _context.abrupt(\"return\", new Promise(function (resolve, reject) {\n            var success = planetArray != undefined;\n            success ? resolve(planetArray) : reject('Query failed');\n          }));\n\n        case 11:\n        case \"end\":\n          return _context.stop();\n      }\n    }\n  }, null, null, null, Promise);\n};\n\nvar setStars = function setStars(arr, data) {\n  var star = arr.TD;\n  var propPlanet = {\n    hostname: data,\n    st_spectype: star[0],\n    st_teff: star[1],\n    st_rad: star[2],\n    st_mass: star[3],\n    st_age: star[4],\n    st_rotp: star[5]\n  };\n  return propPlanet;\n};\n\nvar styles = StyleSheet.create({\n  container: {\n    padding: 20\n  },\n  textInput: {\n    width: 200,\n    backgroundColor: \"gray\",\n    marginRight: 10,\n    borderBottomLeftRadius: 10,\n    borderBottomRightRadius: 10\n  },\n  menuProvider: {},\n  planetScroll: {},\n  searchBar: {\n    flexDirection: \"row\",\n    justifyContent: \"center\",\n    zIndex: 1\n  },\n  infoWrapper: {\n    justifyContent: \"center\",\n    alignContent: \"center\"\n  },\n  headerWrapper: {\n    flexDirection: 'row',\n    justifyContent: 'center',\n    backgroundColor: '#134261',\n    borderWidth: 1,\n    borderColor: '#134261',\n    borderBottomLeftRadius: 40,\n    borderBottomRightRadius: 40,\n    borderTopLeftRadius: 40,\n    borderTopRightRadius: 40\n  },\n  header: {\n    fontSize: 23,\n    fontWeight: \"bold\",\n    color: \"#ffff\"\n  },\n  buttonWrapper: {\n    flexDirection: \"row\",\n    justifyContent: \"center\"\n  },\n  button: {\n    backgroundColor: '#134261',\n    color: \"white\",\n    padding: 10\n  },\n  buttonText: {\n    color: \"white\"\n  }\n});\nexport default Search;","map":{"version":3,"sources":["C:/Users/E/uni/tiea207/exoview/exoview/exoview-frontend/src/screens/Search.js"],"names":["React","useEffect","useState","parse","TouchableOpacity","Menu","MenuProvider","MenuOptions","MenuOption","MenuTrigger","set","Search","navigation","route","foundPlanets","setFoundPlanets","allPlanets","setAllPlanets","searchFilter","setFilter","searchTerm","changeSearchTerm","juoksevaluku","setJuoksevaluku","menuTriggerText","setMenuTriggerText","params","renderFoundPlanets","map","planet","generateKey","parseSearchTerms","Keyboard","dismiss","searchedWord","filteredPlanetsAr","filter","toLowerCase","match","toString","handleTextChange","term","createQuery","hakuehto","undefined","console","log","alku","loppu","hakutermi","changeMenuTrigger","styles","searchBar","textInput","button","buttonText","item","pl_name","keys","idLength","i","id","charAt","Math","floor","random","length","PlanetBrief","props","isVisible","toggleVisibility","renderView","view","infoWrapper","data","hostname","pl_masse","pl_rade","buttonWrapper","handleStarsystem2","handleStarsystem","container","headerWrapper","header","nimi","kutsu","fetchData","then","star","setStars","tahdenplaneetat","system","planets","navigate","fetch","response","text","teksti","objects","planetArray","VOTABLE","RESOURCE","TABLE","DATA","TABLEDATA","TR","Promise","resolve","reject","success","arr","TD","propPlanet","st_spectype","st_teff","st_rad","st_mass","st_age","st_rotp","StyleSheet","create","padding","width","backgroundColor","marginRight","borderBottomLeftRadius","borderBottomRightRadius","menuProvider","planetScroll","flexDirection","justifyContent","zIndex","alignContent","borderWidth","borderColor","borderTopLeftRadius","borderTopRightRadius","fontSize","fontWeight","color"],"mappings":";;;;;;AAAA,OAAO,8BAAP;AACA,OAAOA,KAAP,IAAgBC,SAAhB,EAA2BC,QAA3B,QAA2C,OAA3C;;;;;;;;AAEA,SAASC,KAAT,QAAsB,iBAAtB;AACA,SAASC,gBAAT,QAAiC,8BAAjC;AACA,SAASC,IAAT,EAAeC,YAAf,EAA6BC,WAA7B,EAA0CC,UAA1C,EAAsDC,WAAtD,QAAwE,yBAAxE;AACA,SAASC,GAAT,QAAoB,yBAApB;;AAGA,IAAMC,MAAM,GAAG,SAATA,MAAS,OAA4B;AAAA,MAAzBC,UAAyB,QAAzBA,UAAyB;AAAA,MAAbC,KAAa,QAAbA,KAAa;;AAAA,kBASCX,QAAQ,CAAC,EAAD,CATT;AAAA;AAAA,MAShCY,YATgC;AAAA,MASlBC,eATkB;;AAAA,mBAWHb,QAAQ,CAAC,EAAD,CAXL;AAAA;AAAA,MAWhCc,UAXgC;AAAA,MAWpBC,aAXoB;;AAAA,mBAcLf,QAAQ,CAAC,EAAD,CAdH;AAAA;AAAA,MAchCgB,YAdgC;AAAA,MAclBC,SAdkB;;AAAA,mBAiBAjB,QAAQ,CAAC,EAAD,CAjBR;AAAA;AAAA,MAiBhCkB,UAjBgC;AAAA,MAiBpBC,gBAjBoB;;AAAA,mBAoBCnB,QAAQ,CAAC,CAAD,CApBT;AAAA;AAAA,MAoBhCoB,YApBgC;AAAA,MAoBlBC,eApBkB;;AAAA,oBAuBOrB,QAAQ,CAAC,gBAAD,CAvBf;AAAA;AAAA,MAuBhCsB,eAvBgC;AAAA,MAuBfC,kBAvBe;;AA2BvCxB,EAAAA,SAAS,CAAC,YAAM;AACZgB,IAAAA,aAAa,CAACJ,KAAK,CAACa,MAAP,CAAb;AACH,GAFQ,EAEN,EAFM,CAAT;AAKAzB,EAAAA,SAAS,CAAC,YAAM;AACZc,IAAAA,eAAe,CAACC,UAAD,CAAf;AACH,GAFQ,EAEN,CAACA,UAAD,CAFM,CAAT;;AAMA,MAAMW,kBAAkB,GAAG,SAArBA,kBAAqB,GAAM;AAC7B,WAAOb,YAAY,CAACc,GAAb,CAAiB,UAAAC,MAAM;AAAA,aAAI,oBAAC,WAAD;AAAa,QAAA,UAAU,EAAEjB,UAAzB;AAAqC,QAAA,IAAI,EAAEiB,MAA3C;AAAmD,QAAA,GAAG,EAAEC,WAAW,EAAnE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAAJ;AAAA,KAAvB,CAAP;AACH,GAFD;;AAMA,MAAMC,gBAAgB,GAAG,SAAnBA,gBAAmB,GAAM;AAE3B,QAAGX,UAAU,KAAK,EAAf,IAAqBF,YAAY,KAAK,EAAzC,EAA4C;AACxCc,MAAAA,QAAQ,CAACC,OAAT;AACAd,MAAAA,SAAS,CAAC,EAAD,CAAT;AACAM,MAAAA,kBAAkB,CAAC,gBAAD,CAAlB;AACA,aAAOV,eAAe,CAACC,UAAD,CAAtB;AACH;;AACH,QAAMkB,YAAY,GAAG,MAAMd,UAA3B;AACA,QAAMe,iBAAiB,GAAIjB,YAAY,KAAK,SAAjB,IAA8BA,YAAY,KAAK,UAA/C,GAEvBF,UAAU,CAACoB,MAAX,CAAkB,UAAAP,MAAM;AAAA,aAAIA,MAAM,CAACX,YAAD,CAAN,CAAqBmB,WAArB,GAAmCC,KAAnC,CAAyClB,UAAU,CAACiB,WAAX,EAAzC,CAAJ;AAAA,KAAxB,CAFuB,GAGvBrB,UAAU,CAACoB,MAAX,CAAkB,UAAAP,MAAM;AAAA,aAAIA,MAAM,CAACX,YAAD,CAAN,CAAqBqB,QAArB,GAAgCD,KAAhC,CAAsCJ,YAAtC,CAAJ;AAAA,KAAxB,CAHJ;AAKAnB,IAAAA,eAAe,CAACoB,iBAAD,CAAf;AACAH,IAAAA,QAAQ,CAACC,OAAT;AAED,GAjBD;;AAmBA,MAAMO,gBAAgB,GAAG,SAAnBA,gBAAmB,CAACC,IAAD,EAAU;AAC/B,QAAIA,IAAI,KAAK,EAAb,EAAiB;AACbtB,MAAAA,SAAS,CAAC,EAAD,CAAT;AAEA,aAAOJ,eAAe,CAACC,UAAD,CAAtB;AACH;;AAEDK,IAAAA,gBAAgB,CAACoB,IAAD,CAAhB;AACH,GARD;;AAWA,MAAMC,WAAW,GAAG,SAAdA,WAAc,GAAM;AACtB,QAAIC,QAAQ,GAAGzB,YAAf;;AAIA,QAAIyB,QAAQ,KAAK,EAAb,IAAmBA,QAAQ,KAAKC,SAApC,EAA+C;AAC3CC,MAAAA,OAAO,CAACC,GAAR,CAAYC,IAAI,GAAWC,KAA3B;AACA,aAAOD,IAAI,GAAcC,KAAzB;AACH;;AAED,QAAIC,SAAS,GAAG,aAAa7B,UAAb,GAA0B,KAA1C;AACAyB,IAAAA,OAAO,CAACC,GAAR,CAAYC,IAAI,GAAGJ,QAAP,GAAkBM,SAA9B;AACA,WAAOF,IAAI,GAAGJ,QAAP,GAAkBM,SAAzB;AACH,GAbD;;AAeA,MAAMC,iBAAiB,GAAG,SAApBA,iBAAoB,CAACd,MAAD,EAAY;AAClC,YAAQA,MAAR;AACI,WAAK,SAAL;AACIX,QAAAA,kBAAkB,CAAC,aAAD,CAAlB;AACA;;AACJ,WAAK,UAAL;AACIA,QAAAA,kBAAkB,CAAC,WAAD,CAAlB;AACA;;AACJ,WAAK,SAAL;AACIA,QAAAA,kBAAkB,CAAC,QAAD,CAAlB;AACA;;AACJ,WAAK,UAAL;AACIA,QAAAA,kBAAkB,CAAC,cAAD,CAAlB;AACA;;AAEJ;AACIA,QAAAA,kBAAkB,CAAC,gBAAD,CAAlB;AACA;AAhBR;AAmBH,GApBD;;AAuBA,SAEQ,oBAAC,YAAD;AAAkC,IAAA,EAAE,MAApC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACI,oBAAC,IAAD;AAAM,IAAA,QAAQ,EAAE,kBAAAW,MAAM,EACF;AACIjB,MAAAA,SAAS,CAACiB,MAAD,CAAT;AACAc,MAAAA,iBAAiB,CAACd,MAAD,CAAjB;AACH,KAJrB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAKQ,oBAAC,WAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACI,oBAAC,IAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAOZ,eAAP,CADJ,CALR,EASQ,oBAAC,WAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACI,oBAAC,UAAD;AAAY,IAAA,KAAK,EAAE,SAAnB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACI,oBAAC,IAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBADJ,CADJ,EAKI,oBAAC,UAAD;AAAY,IAAA,KAAK,EAAE,UAAnB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACI,oBAAC,IAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iBADJ,CALJ,EASI,oBAAC,UAAD;AAAY,IAAA,KAAK,EAAE,SAAnB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACI,oBAAC,IAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cADJ,CATJ,EAaI,oBAAC,UAAD;AAAY,IAAA,KAAK,EAAE,UAAnB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACI,oBAAC,IAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBADJ,CAbJ,CATR,CADJ,EA6BQ,oBAAC,IAAD;AAAM,IAAA,KAAK,EAAE2B,MAAM,CAACC,SAApB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACI,oBAAC,SAAD;AAAW,IAAA,KAAK,EAAED,MAAM,CAACE,SAAzB;AAAoC,IAAA,YAAY,EAAE,sBAAAZ,IAAI;AAAA,aAAID,gBAAgB,CAACC,IAAD,CAApB;AAAA,KAAtD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADJ,EAEA,oBAAC,gBAAD;AAAkB,IAAA,KAAK,EAAEU,MAAM,CAACG,MAAhC;AAAwC,IAAA,OAAO,EAAE;AAAA,aAAMvB,gBAAgB,EAAtB;AAAA,KAAjD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACI,oBAAC,IAAD;AAAM,IAAA,KAAK,EAAEoB,MAAM,CAACI,UAApB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cADJ,CAFA,CA7BR,EAwCQ,oBAAC,QAAD;AACI,IAAA,IAAI,EAAEzC,YADV;AAEI,IAAA,UAAU,EAAE;AAAA,UAAG0C,IAAH,SAAGA,IAAH;AAAA,aACR,oBAAC,WAAD;AAAa,QAAA,UAAU,EAAE5C,UAAzB;AAAqC,QAAA,IAAI,EAAE4C,IAA3C;AAAiD,QAAA,UAAU,EAAE1C,YAA7D;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QADQ;AAAA,KAFhB;AAKI,IAAA,YAAY,EAAE,sBAAC0C,IAAD;AAAA,aAAUA,IAAI,CAACC,OAAf;AAAA,KALlB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAxCR,CAFR;AAuDH,CAvKD;;AA0KA,IAAM3B,WAAW,GAAG,SAAdA,WAAc,GAAM;AACtB,MAAM4B,IAAI,GAAG,sCAAb;AAEA,MAAMC,QAAQ,GAAG,EAAjB;AAEA,MAAIC,CAAC,GAAG,CAAR;AAEA,MAAIC,EAAE,GAAG,EAAT;;AAEA,SAAOD,CAAC,GAAGD,QAAX,EAAqB;AACjBE,IAAAA,EAAE,GAAGA,EAAE,GAAGH,IAAI,CAACI,MAAL,CAAYC,IAAI,CAACC,KAAL,CAAWD,IAAI,CAACE,MAAL,KAAgBF,IAAI,CAACC,KAAL,CAAWN,IAAI,CAACQ,MAAhB,CAA3B,CAAZ,CAAV;AACAN,IAAAA,CAAC;AACJ;;AAED,SAAOC,EAAP;AACH,CAfD;;AAqBA,IAAMM,WAAW,GAAG,SAAdA,WAAc,CAAEC,KAAF,EAAa;AAE7B,MAAIC,SAAS,GAAG,KAAhB;;AAEA,MAAMC,gBAAgB,GAAG,SAAnBA,gBAAmB,GAAM;AAC3BD,IAAAA,SAAS,GAAG,CAACA,SAAb;AACH,GAFD;;AAIA,MAAME,UAAU,GAAG,SAAbA,UAAa,GAAM;AACrB,QAAIF,SAAJ,EAAe;AACX,aAAOG,IAAP;AACH;;AAED,WAAO,IAAP;AACH,GAND;;AAQA,MAAIA,IAAI,GAAI,oBAAC,IAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACI,oBAAC,IAAD;AAAM,IAAA,KAAK,EAAErB,MAAM,CAACsB,WAApB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACI,oBAAC,IAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACiBL,KAAK,CAACM,IAAN,CAAWC,QAD5B,CADJ,EAII,oBAAC,IAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBACaP,KAAK,CAACM,IAAN,CAAWE,QADxB,CAJJ,EAOI,oBAAC,IAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iBACcR,KAAK,CAACM,IAAN,CAAWG,OADzB,CAPJ,CADJ,EAiBI,oBAAC,IAAD;AAAM,IAAA,KAAK,EAAI1B,MAAM,CAAC2B,aAAtB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACI,oBAAC,gBAAD;AAAkB,IAAA,KAAK,EAAE3B,MAAM,CAACG,MAAhC;AAAwC,IAAA,OAAO,EAAE;AAAA,aAAMyB,iBAAiB,CAACX,KAAD,CAAvB;AAAA,KAAjD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAiF,oBAAC,IAAD;AAAM,IAAA,KAAK,EAAEjB,MAAM,CAACI,UAApB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBAAjF,CADJ,EAEI,oBAAC,gBAAD;AAAkB,IAAA,KAAK,EAAEJ,MAAM,CAACG,MAAhC;AAAwC,IAAA,OAAO,EAAE;AAAA,aAAM0B,gBAAgB,CAACZ,KAAD,CAAtB;AAAA,KAAjD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAgF,oBAAC,IAAD;AAAM,IAAA,KAAK,EAAEjB,MAAM,CAACI,UAApB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBAAhF,CAFJ,CAjBJ,CAAZ;AAuBA,SACI,oBAAC,IAAD;AAAM,IAAA,KAAK,EAAEJ,MAAM,CAAC8B,SAApB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACI,oBAAC,IAAD;AAAM,IAAA,KAAK,EAAI9B,MAAM,CAAC+B,aAAtB;AAAqC,IAAA,OAAO,EAAIZ,gBAAgB,EAAhE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACI,oBAAC,IAAD;AAAM,IAAA,KAAK,EAAInB,MAAM,CAACgC,MAAtB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACMf,KAAK,CAACM,IAAN,CAAWjB,OADjB,CADJ,CADJ,EAMKc,UAAU,EANf,CADJ;AAUH,CAjDD;;AAmDA,IAAMS,gBAAgB,GAAG,SAAnBA,gBAAmB,CAACZ,KAAD,EAAOpD,UAAP,EAAsB;AAE3C,MAAIoE,IAAI,GAAGhB,KAAK,CAACM,IAAN,CAAWjB,OAAtB;AACA,MAAI4B,KAAK,GAAG,kKAAgKD,IAAhK,GAAqK,4BAAjL;AACAE,EAAAA,SAAS,CAACD,KAAD,CAAT,CACCE,IADD,CACM,UAACb,IAAD,EAAS;AACX,QAAIc,IAAI,GAAGC,QAAQ,CAACf,IAAD,EAAMN,KAAK,CAACM,IAAN,CAAWC,QAAjB,CAAnB;AACA,QAAIe,eAAe,GAAGtB,KAAK,CAACpD,UAAN,CAAiBoB,MAAjB,CAAwB,UAAAP,MAAM;AAAA,aAAIA,MAAM,CAAC,UAAD,CAAN,CAAmBS,KAAnB,CAAyBkD,IAAI,CAACb,QAA9B,CAAJ;AAAA,KAA9B,CAAtB;AACA,QAAMgB,MAAM,GAAG;AAACH,MAAAA,IAAI,EAAEA,IAAP;AAAaI,MAAAA,OAAO,EAAEF;AAAtB,KAAf;AACAtB,IAAAA,KAAK,CAACxD,UAAN,CAAiBiF,QAAjB,CAA0B,YAA1B,EAAwCF,MAAxC;AACH,GAND;AAQH,CAZD;;AAaA,IAAMZ,iBAAiB,GAAG,SAApBA,iBAAoB,CAACX,KAAD,EAAOpD,UAAP,EAAsB;AAE5C,MAAIoE,IAAI,GAAGhB,KAAK,CAACM,IAAN,CAAWjB,OAAtB;AACA,MAAI4B,KAAK,GAAG,kKAAgKD,IAAhK,GAAqK,4BAAjL;AACAE,EAAAA,SAAS,CAACD,KAAD,CAAT,CACCE,IADD,CACM,UAACb,IAAD,EAAS;AACX,QAAIc,IAAI,GAAGC,QAAQ,CAACf,IAAD,EAAMN,KAAK,CAACM,IAAN,CAAWC,QAAjB,CAAnB;AACA,QAAIe,eAAe,GAAGtB,KAAK,CAACpD,UAAN,CAAiBoB,MAAjB,CAAwB,UAAAP,MAAM;AAAA,aAAIA,MAAM,CAAC,UAAD,CAAN,CAAmBS,KAAnB,CAAyBkD,IAAI,CAACb,QAA9B,CAAJ;AAAA,KAA9B,CAAtB;AACA,QAAMgB,MAAM,GAAG;AAACH,MAAAA,IAAI,EAAEA,IAAP;AAAaI,MAAAA,OAAO,EAAEF;AAAtB,KAAf;AACAtB,IAAAA,KAAK,CAACxD,UAAN,CAAiBiF,QAAjB,CAA0B,aAA1B,EAAwC;AAAEhE,MAAAA,MAAM,EAACuC,KAAK,CAACM,IAAf;AAAqBiB,MAAAA,MAAM,EAAEA;AAA7B,KAAxC;AACH,GAND;AAQH,CAZD;;AAaA,IAAML,SAAS,GAAG,SAAZA,SAAY,CAAQlB,KAAR;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,2CACS0B,KAAK,CAAC1B,KAAD,CADd;;AAAA;AACR2B,UAAAA,QADQ;AAAA;AAAA,2CAGOA,QAAQ,CAACC,IAAT,EAHP;;AAAA;AAGRC,UAAAA,MAHQ;AAAA;AAAA,2CAIQ9F,KAAK,CAAC8F,MAAD,CAJb;;AAAA;AAIRC,UAAAA,OAJQ;AAMRC,UAAAA,WANQ,GAMMD,OAAO,CAACE,OAAR,CAAgBC,QAAhB,CAAyBC,KAAzB,CAA+BC,IAA/B,CAAoCC,SAApC,CAA8CC,EANpD;AAAA,2CAOP,IAAIC,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;AACpC,gBAAIC,OAAO,GAAGV,WAAW,IAAIvD,SAA7B;AACAiE,YAAAA,OAAO,GAAGF,OAAO,CAACR,WAAD,CAAV,GAA0BS,MAAM,CAAC,cAAD,CAAvC;AACH,WAHM,CAPO;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,CAAlB;;AAaM,IAAMnB,QAAQ,GAAG,SAAXA,QAAW,CAACqB,GAAD,EAAKpC,IAAL,EAAc;AAC7B,MAAMc,IAAI,GAAGsB,GAAG,CAACC,EAAjB;AACA,MAAMC,UAAU,GACZ;AACIrC,IAAAA,QAAQ,EAAED,IADd;AAEIuC,IAAAA,WAAW,EAAEzB,IAAI,CAAC,CAAD,CAFrB;AAGI0B,IAAAA,OAAO,EAAE1B,IAAI,CAAC,CAAD,CAHjB;AAII2B,IAAAA,MAAM,EAAE3B,IAAI,CAAC,CAAD,CAJhB;AAKI4B,IAAAA,OAAO,EAAE5B,IAAI,CAAC,CAAD,CALjB;AAMI6B,IAAAA,MAAM,EAAE7B,IAAI,CAAC,CAAD,CANhB;AAOI8B,IAAAA,OAAO,EAAE9B,IAAI,CAAC,CAAD;AAPjB,GADJ;AAUA,SAAOwB,UAAP;AACH,CAbC;;AAmBN,IAAM7D,MAAM,GAAGoE,UAAU,CAACC,MAAX,CAAkB;AAC7BvC,EAAAA,SAAS,EAAE;AACPwC,IAAAA,OAAO,EAAE;AADF,GADkB;AAK7BpE,EAAAA,SAAS,EAAE;AACPqE,IAAAA,KAAK,EAAE,GADA;AAEPC,IAAAA,eAAe,EAAE,MAFV;AAGPC,IAAAA,WAAW,EAAE,EAHN;AAIPC,IAAAA,sBAAsB,EAAE,EAJjB;AAKPC,IAAAA,uBAAuB,EAAE;AALlB,GALkB;AAa7BC,EAAAA,YAAY,EAAC,EAbgB;AAgB7BC,EAAAA,YAAY,EAAC,EAhBgB;AAmB7B5E,EAAAA,SAAS,EAAE;AAEP6E,IAAAA,aAAa,EAAE,KAFR;AAGPC,IAAAA,cAAc,EAAE,QAHT;AAIPC,IAAAA,MAAM,EAAC;AAJA,GAnBkB;AA0B7B1D,EAAAA,WAAW,EAAE;AACTyD,IAAAA,cAAc,EAAE,QADP;AAETE,IAAAA,YAAY,EAAE;AAFL,GA1BgB;AA+B7BlD,EAAAA,aAAa,EAAE;AACX+C,IAAAA,aAAa,EAAC,KADH;AAEXC,IAAAA,cAAc,EAAC,QAFJ;AAGXP,IAAAA,eAAe,EAAE,SAHN;AAIXU,IAAAA,WAAW,EAAC,CAJD;AAKXC,IAAAA,WAAW,EAAE,SALF;AAMXT,IAAAA,sBAAsB,EAAE,EANb;AAOXC,IAAAA,uBAAuB,EAAC,EAPb;AAQXS,IAAAA,mBAAmB,EAAE,EARV;AASXC,IAAAA,oBAAoB,EAAE;AATX,GA/Bc;AA2C7BrD,EAAAA,MAAM,EAAE;AACJsD,IAAAA,QAAQ,EAAE,EADN;AAEJC,IAAAA,UAAU,EAAE,MAFR;AAGJC,IAAAA,KAAK,EAAE;AAHH,GA3CqB;AAiD7B7D,EAAAA,aAAa,EAAE;AACXmD,IAAAA,aAAa,EAAE,KADJ;AAEXC,IAAAA,cAAc,EAAE;AAFL,GAjDc;AAsD7B5E,EAAAA,MAAM,EAAC;AACHqE,IAAAA,eAAe,EAAC,SADb;AAEHgB,IAAAA,KAAK,EAAE,OAFJ;AAGHlB,IAAAA,OAAO,EAAE;AAHN,GAtDsB;AA4D7BlE,EAAAA,UAAU,EAAE;AACRoF,IAAAA,KAAK,EAAE;AADC;AA5DiB,CAAlB,CAAf;AAkEA,eAAehI,MAAf","sourcesContent":["import 'react-native-gesture-handler';\r\nimport React, { useEffect, useState } from 'react';\r\nimport {  FlatList, Keyboard, View, Text, TextInput, StyleSheet, ScrollView } from 'react-native';\r\nimport { parse } from 'fast-xml-parser';\r\nimport { TouchableOpacity } from 'react-native-gesture-handler';\r\nimport { Menu, MenuProvider, MenuOptions, MenuOption, MenuTrigger} from \"react-native-popup-menu\";\r\nimport { set } from 'react-native-reanimated';\r\n\r\n//Planeettojen etsimisikkuna\r\nconst Search = ({ navigation, route } ) => {\r\n\r\n    /*Aloitusmaksimi queryssa\r\n    var start = 0;\r\n    var alku = \"https://exoplanetarchive.ipac.caltech.edu/TAP/sync?query=select+hostname,pl_name,pl_rade,pl_bmasse,pl_bmassj,pl_radj+from+pscomppars+where+\";\r\n\tvar loppu = \"+default_flag+=+1\";//format=csv;\r\n\t*/\r\n\r\n    //Löydetyt planeetat\r\n    const [foundPlanets, setFoundPlanets] = useState([]) \r\n\r\n    const [allPlanets, setAllPlanets] = useState([])\r\n\r\n    //Hakufiltteri\r\n    const [searchFilter, setFilter] = useState('')\r\n\r\n    //Hakutermi\r\n    const [searchTerm, changeSearchTerm] = useState('')\r\n\r\n    //laitettava tänne, jotta päivittyy aina\r\n    const [juoksevaluku, setJuoksevaluku] = useState(0)\r\n\r\n    //Menutriggerin tekstin vaihto\r\n    const [menuTriggerText, setMenuTriggerText] = useState('Search options')\r\n\r\n\r\n    //Aloittaa hakemalla datan\r\n    useEffect(() => {\r\n        setAllPlanets(route.params)\r\n    }, []);\r\n\r\n    //asetetaan alussa kaikki planeetat löytyneiksi\r\n    useEffect(() => {\r\n        setFoundPlanets(allPlanets)\r\n    }, [allPlanets])\r\n\r\n\r\n    //Tekee löydetyistä planeetoista katseltavia komponentteja\r\n    const renderFoundPlanets = () => {\r\n        return foundPlanets.map(planet => <PlanetBrief navigation={navigation} data={planet} key={generateKey()}/>)\r\n    }\r\n\r\n\r\n    //Käsittelee hakutermin ja -filtterin\r\n    const parseSearchTerms = () => {\r\n        \r\n        if(searchTerm === \"\" || searchFilter === \"\"){ \r\n            Keyboard.dismiss(); \r\n            setFilter(\"\"); \r\n            setMenuTriggerText('Search Options'); \r\n            return setFoundPlanets(allPlanets);\r\n        }\r\n      const searchedWord = '^' + searchTerm\r\n      const filteredPlanetsAr = (searchFilter !== 'pl_rade' && searchFilter !== 'pl_masse' \r\n      \r\n       ? (allPlanets.filter(planet => planet[searchFilter].toLowerCase().match(searchTerm.toLowerCase())))\r\n       : (allPlanets.filter(planet => planet[searchFilter].toString().match(searchedWord))))\r\n      \r\n      setFoundPlanets(filteredPlanetsAr)\r\n      Keyboard.dismiss()\r\n      \r\n    }\r\n\r\n    const handleTextChange = (term) => {\r\n        if (term === '') {\r\n            setFilter(\"\"); \r\n            //setMenuTriggerText('Search Options'); \r\n            return setFoundPlanets(allPlanets);\r\n        }\r\n\r\n        changeSearchTerm(term)\r\n    }\r\n   \r\n    //Luo uuden api queryn\r\n    const createQuery = () => {\r\n        var hakuehto = searchFilter;\r\n\r\n        //var rajat = '+rownum+>=' + juoksevaluku + '+and+rownum+<+' + (juoksevaluku+9) +'+and'\r\n        \r\n        if (hakuehto === '' || hakuehto === undefined) {\r\n            console.log(alku+/*rajat+*/loppu);\r\n            return alku + /*rajat+*/ loppu;\r\n        } \r\n        //+and'    + /*rajat+*/ loppu\r\n        var hakutermi = '+like+\\'' + searchTerm + '%\\''\r\n        console.log(alku + hakuehto + hakutermi);\r\n        return alku + hakuehto + hakutermi;\r\n    }\r\n\r\n    const changeMenuTrigger = (filter) => {\r\n        switch (filter) {\r\n            case \"pl_name\":\r\n                setMenuTriggerText(\"Planet name\");\r\n                break;\r\n            case \"hostname\":\r\n                setMenuTriggerText(\"Host star\");\r\n                break;\r\n            case \"pl_rade\":\r\n                setMenuTriggerText(\"Radius\");\r\n                break;\r\n            case \"pl_masse\":\r\n                setMenuTriggerText(\"Planet masse\");\r\n                break;\r\n                \r\n            default:\r\n                setMenuTriggerText(\"Search options\");\r\n                break;\r\n\r\n        }\r\n    }\r\n    \r\n    //Palauttaa hakunäkymän\r\n    return (\r\n        \r\n            <MenuProvider /*style={padding}*/ on>\r\n                <Menu onSelect={filter => \r\n                                    {\r\n                                        setFilter(filter);\r\n                                        changeMenuTrigger(filter);\r\n                                    }}>\r\n                        <MenuTrigger /*onPress={() => setMenuProviderStyle()}*/>\r\n                            <Text>{menuTriggerText}</Text>\r\n                        </MenuTrigger>\r\n\r\n                        <MenuOptions>\r\n                            <MenuOption value={\"pl_name\"}>\r\n                                <Text>Planet name</Text>\r\n                            </MenuOption>\r\n                            \r\n                            <MenuOption value={\"hostname\"}>\r\n                                <Text>Host star</Text>\r\n                            </MenuOption>\r\n\r\n                            <MenuOption value={\"pl_rade\"}>\r\n                                <Text>Radius</Text>\r\n                            </MenuOption>\r\n\r\n                            <MenuOption value={\"pl_masse\"}>\r\n                                <Text>planet masse</Text>\r\n                            </MenuOption>\r\n                        </MenuOptions>\r\n\r\n                    </Menu>\r\n                    <View style={styles.searchBar}>\r\n                        <TextInput style={styles.textInput} onChangeText={term => handleTextChange(term)}></TextInput>\r\n                    <TouchableOpacity style={styles.button} onPress={() => parseSearchTerms()}>\r\n                        <Text style={styles.buttonText}>Search</Text>\r\n                    </TouchableOpacity>    \r\n                    </View>\r\n                    {/*\r\n                    <ScrollView onScroll={({nativeEvent}) => {loadNext(nativeEvent);}} scrollEventThrottle={16}>\r\n                        {renderFoundPlanets()}\r\n                    </ScrollView> */}\r\n\r\n                    <FlatList\r\n                        data={foundPlanets}\r\n                        renderItem={({ item }) => (\r\n                            <PlanetBrief navigation={navigation} data={item} allPlanets={foundPlanets} />\r\n                        )}\r\n                        keyExtractor={(item) => item.pl_name}\r\n                        >\r\n                       \r\n                    </FlatList>\r\n\r\n            </MenuProvider>     \r\n\r\n    )\r\n}\r\n\r\n//Luo id:n planeettakomponenteille\r\nconst generateKey = () => {\r\n    const keys = '1234567890abcdefghijklmnopqrstuvwxyz'\r\n\r\n    const idLength = 10\r\n\r\n    let i = 0;\r\n\r\n    let id = '';\r\n\r\n    while (i < idLength) {\r\n        id = id + keys.charAt(Math.floor(Math.random() * Math.floor(keys.length)))\r\n        i++;\r\n    }\r\n\r\n    return id;\r\n}\r\n\r\n//Planeetan kevyet tiedot search-näkymään\r\n//TODO komponentin voinee eriyttää\r\n//TODO infon collapse\r\n//TODO n/a jos tietoa ei ole saatavilla\r\nconst PlanetBrief = ( props ) => {\r\n\r\n    var isVisible = false;\r\n\r\n    const toggleVisibility = () => {\r\n        isVisible = !isVisible;\r\n    }\r\n\r\n    const renderView = () => {\r\n        if (isVisible) {\r\n            return view;\r\n        }\r\n\r\n        return null;\r\n    }\r\n\r\n    var view =  <View>    \r\n                    <View style={styles.infoWrapper}>\r\n                        <Text>\r\n                            Host star: { props.data.hostname}\r\n                        </Text>\r\n                        <Text>\r\n                            Masse: { props.data.pl_masse}\r\n                        </Text>\r\n                        <Text>\r\n                            Radius: { props.data.pl_rade}\r\n                        </Text>\r\n                        {/*\r\n                        <Text>\r\n                            Discovery year: { props.data.disc_year}\r\n                        </Text>\r\n                        */}\r\n                    </View>\r\n                    <View style = {styles.buttonWrapper}>\r\n                        <TouchableOpacity style={styles.button} onPress={() => handleStarsystem2(props)}><Text style={styles.buttonText}>View planet</Text></TouchableOpacity>\r\n                        <TouchableOpacity style={styles.button} onPress={() => handleStarsystem(props)}><Text style={styles.buttonText}>View host star</Text></TouchableOpacity>\r\n                    </View>\r\n                </View>\r\n\r\n    return (\r\n        <View style={styles.container}>\r\n            <View style = {styles.headerWrapper} onPress = {toggleVisibility()}>\r\n                <Text style = {styles.header}>\r\n                    { props.data.pl_name }\r\n                </Text>\r\n            </View>\r\n            {renderView()}\r\n        </View>\r\n    )\r\n}\r\n\r\nconst handleStarsystem = (props,allPlanets) => {\r\n    //console.log(props.allPlanets.length)\r\n    var nimi = props.data.pl_name;\r\n    var kutsu = \"https://exoplanetarchive.ipac.caltech.edu/TAP/sync?query=select+top+1+st_spectype,st_teff,st_rad,st_mass,st_age,st_rotp+from+pscomppars+where+pl_name+like+\\'\"+nimi+\"\\'+order+by+disc_year+desc\";\r\n    fetchData(kutsu)\r\n    .then((data) =>{\r\n        var star = setStars(data,props.data.hostname)\r\n        var tahdenplaneetat = props.allPlanets.filter(planet => planet['hostname'].match(star.hostname))\r\n        const system = {star: star, planets: tahdenplaneetat}\r\n        props.navigation.navigate('StarSystem', system)\r\n    })\r\n\r\n}\r\nconst handleStarsystem2 = (props,allPlanets) => {\r\n    //console.log(props.allPlanets.length)\r\n    var nimi = props.data.pl_name;\r\n    var kutsu = \"https://exoplanetarchive.ipac.caltech.edu/TAP/sync?query=select+top+1+st_spectype,st_teff,st_rad,st_mass,st_age,st_rotp+from+pscomppars+where+pl_name+like+\\'\"+nimi+\"\\'+order+by+disc_year+desc\";\r\n    fetchData(kutsu)\r\n    .then((data) =>{\r\n        var star = setStars(data,props.data.hostname)\r\n        var tahdenplaneetat = props.allPlanets.filter(planet => planet['hostname'].match(star.hostname))\r\n        const system = {star: star, planets: tahdenplaneetat}\r\n        props.navigation.navigate('Information',{ planet:props.data, system: system} )\r\n    })\r\n\r\n}\r\nconst fetchData = async ( props ) => {\r\n    const response = await fetch(props);\r\n\r\n    const teksti = await response.text();\r\n    const objects = await parse(teksti);\r\n\r\n    const planetArray = objects.VOTABLE.RESOURCE.TABLE.DATA.TABLEDATA.TR;\r\n    return new Promise((resolve, reject) => {\r\n        var success = planetArray != undefined;\r\n        success ? resolve(planetArray) : reject('Query failed');\r\n    })\r\n}\r\n    \r\n      const setStars = (arr,data) => {\r\n        const star = arr.TD\r\n        const propPlanet =\r\n            {\r\n                hostname: data,\r\n                st_spectype: star[0],\r\n                st_teff: star[1],\r\n                st_rad: star[2],\r\n                st_mass: star[3],\r\n                st_age: star[4],\r\n                st_rotp: star[5]\r\n            }\r\n        return propPlanet\r\n    }\r\n     \r\n\r\n\r\n\r\n\r\nconst styles = StyleSheet.create({\r\n    container: {\r\n        padding: 20\r\n    },\r\n\r\n    textInput: {\r\n        width: 200,\r\n        backgroundColor: \"gray\",\r\n        marginRight: 10,\r\n        borderBottomLeftRadius: 10,\r\n        borderBottomRightRadius: 10\r\n    },\r\n\r\n    menuProvider:{\r\n        \r\n    },\r\n    planetScroll:{\r\n        \r\n    },\r\n    searchBar: {\r\n    \r\n        flexDirection: \"row\",\r\n        justifyContent: \"center\",\r\n        zIndex:1\r\n    },\r\n\r\n    infoWrapper: {\r\n        justifyContent: \"center\",\r\n        alignContent: \"center\"\r\n    },\r\n\r\n    headerWrapper: {\r\n        flexDirection:'row',\r\n        justifyContent:'center',\r\n        backgroundColor: '#134261',\r\n        borderWidth:1,\r\n        borderColor: '#134261',\r\n        borderBottomLeftRadius: 40,\r\n        borderBottomRightRadius:40,\r\n        borderTopLeftRadius: 40,\r\n        borderTopRightRadius: 40\r\n    },\r\n\r\n    header: {\r\n        fontSize: 23,\r\n        fontWeight: \"bold\",\r\n        color: \"#ffff\"\r\n    },\r\n\r\n    buttonWrapper: {\r\n        flexDirection: \"row\",\r\n        justifyContent: \"center\"\r\n    },\r\n\r\n    button:{\r\n        backgroundColor:'#134261',\r\n        color: \"white\",\r\n        padding: 10\r\n    },\r\n\r\n    buttonText: {\r\n        color: \"white\"\r\n    }\r\n});\r\n\r\n\r\nexport default Search;"]},"metadata":{},"sourceType":"module"}